diff -uNr zlib-1.2.12/inflate.c zlib-1.2.12.mod/inflate.c
--- zlib-1.2.12/inflate.c	2022-03-28 07:39:42.000000000 +0800
+++ zlib-1.2.12.mod/inflate.c	2022-08-26 11:27:41.321341704 +0800
@@ -764,8 +764,9 @@
                 if (copy > have) copy = have;
                 if (copy) {
                     if (state->head != Z_NULL &&
-                        state->head->extra != Z_NULL) {
-                        len = state->head->extra_len - state->length;
+                        state->head->extra != Z_NULL &&
+                        (len = state->head->extra_len - state->length) <
+			state->head->extra_max) {
                         zmemcpy(state->head->extra + len, next,
                                 len + copy > state->head->extra_max ?
                                 state->head->extra_max - len : copy);
